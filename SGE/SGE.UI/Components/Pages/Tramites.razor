@page "/tramites/{IdUsuario:Int}"
@using global::SGE.Aplicacion
@using global::SGE.Repositorios 

<div class="container-lista-tramites">
    <h2> Lista de tramites </h2>
        @* aca tendrian que mostrarse todos los tramites (JAJA no se como hacerlo)*@
</div>

<button id="altaButton">Dar de Alta Tramite</button>
    
    <form id="altaForm" @onsubmit="DarAltaTramite">
        <label for="id">ID:</label>
        <input type="number" id="id" @bind="id" placeholder="Ingrese el ID" required><br>

        <label for="expedienteID">Expediente ID:</label>
        <input type="number" id="expedienteID" @bind="expedienteID" placeholder="Ingrese el Expediente ID" required><br>

        <label for="contenido">Contenido:</label>
        <input type="text" id="contenido" @bind="contenido" placeholder="Ingrese el Contenido" required><br>

        <label for="idUsuario">ID Usuario:</label>
        <input type="number" id="idUsuario" @bind="idUsuario" placeholder="Ingrese el ID Usuario" required><br>

        <label for="etiqueta">Etiqueta:</label>
        <select id="etiqueta" @bind="etiqueta" required>
            <option value="EscritoPresentado">Escrito presentado</option>
            <option value="Despacho">Despacho</option>
            <option value="Notificacion">Notificacion</option>
            <option value="Resolucion">Resolución</option>
            <option value="PaseAEstudio">Pase a Estudio</option>
            <option value="PaseAlArchivo">Pase al Archivo</option>
        </select><br>

        <button type="enviar-tramite-alta-button">Enviar</button>
    </form>

@code {
    // @using global::SGE.Repositorios  PUEDE QUE ESTO ESTE RE MAL linea 2
    private int? expedienteID;
    private string? contenido;
    private int idUsuario;
    private EtiquetaTramite.Etiquetas? etiqueta; 
    private void DarAltaTramite(){ 
        
        //Copie ejecutar de registrar usuario
        var repo = new RepositorioTramiteSQLite();
        TramiteValidador validador = new TramiteValidador(repo);
        CasoDeUsoTramiteAlta registro = new CasoDeUsoTramiteAlta(repo, validador); 

        try{
            var etiqueta = new EtiquetaTramite();
            var tramite = new Tramite(expedienteID, contenido,etiqueta);
            registro.Ejecutar(expedienteID,   ) //Por que pide tramite? habria que mandar los datos de forma campo a campo. ¿Como le mando la id de usuario?
        }
        catch(RepositorioException ex){
            ventanaExcepcion.Mensaje = $"{ex.Message}";
            ventanaExcepcion.Mostrar();
        }
    }
}